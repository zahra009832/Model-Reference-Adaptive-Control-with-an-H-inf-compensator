clc
clear all
syms p1 p2 p3 q1 q2 q3
a=[0 1;-2 -4];
b=[0 ;-4];
c=[5 2.5];
[num1,den1]=ss2tf(a,b,c,0);
g=tf(num1,den1)
p=[p1 p2;p2 p3];
t=a'*p+p*a+p*b*((1/3)-1)*b'*p+(1/3)*c'*c+eye(2)
% P=solve('-4*y-32/3*y^2+28/3','x-4*y-2*z-32/3*y*z+25/6', '2*y-8*z-32/3*z^2+37/12')
p1=[2.7892 0.7665;0.7665 0.3822];
eig(p)
k=(-1/2)*b'*p1
q=[q1 q2;q2 q3];
r=a*q+q*a'+eye(2)+4*b*b'+((1/4)-1)*q*c'*c*q
% Q=solve('2*q2+1+(-75/4*q1-75/8*q2)*q1+(-75/8*q1-75/16*q2)*q2','-2*q1-4*q2+q3+(-75/4*q2-75/8*q3)*q1+(-75/8*q2-75/16*q3)*q2','-4*q2-8*q3+65+(-75/4*q2-75/8*q3)*q2+(-75/8*q2-75/16*q3)*q3')
% eig(q)
q1=[.2947 -.2904;-.2904 3.4492];
L=q1*c'
a1=a+b*k-L*c
eig(a1)
[num,den]=ss2tf(a1,L,k,0);
h=tf(num,den)
